# HMAC demo

Наглядная демонстрация HMAC-SHA256 и сценариев передачи сообщений:

- честная передача;
- атака «man-in-the-middle» с подменой сообщения;
- повторная отправка (replay) ранее перехваченного пакета.
- интерактивный режим, где пользователь сам выступает в роли MitM.

Python-скрипты в корне показывают ту же логику в консоли. Вся web-часть лежит в `web/`.

## Как запустить web-демо

1. Открой `web/index.html` в браузере (достаточно двойного клика) или подними локальный сервер из корня проекта:  
   `python -m http.server 8000` и открой http://localhost:8000/web/
2. Вверху показан текущий общий секрет (генерируется при загрузке). Кнопка «Новый ключ» обновляет его и очищает историю Nonce.
3. Нажимай «Запустить» на карточке нужного сценария. Логи ниже показывают, что происходит с пакетом, MAC и Nonce.
4. Кнопка «Режим фокуса» сворачивает сетку в одиночный сценарий на всю ширину; клик по карточке переключает активный сценарий.
5. В логах есть акторы (A/M/B) и кнопка «Детали», которая разворачивает сериализованные данные (сообщение, Nonce, MAC).
6. В «Интерактивном MitM» можно задать исходное и подменённое сообщение, увидеть ожидаемый/фактический MAC.

## Что внутри

- `web/js/hmac.js` — ручная реализация HMAC поверх браузерного SHA-256: выравнивание ключа до 64 байт, XOR с ipad/opad, вложенные хеши, константное сравнение.
- `web/js/simulation.js` — создание пакетов (message || nonce), проверка MAC, отслеживание повторных Nonce и три сценария.
- `web/js/ui.js` и `web/js/main.js` — связка логики с интерфейсом и вывод событий.
- `web/styles.css` — оформление, делающее результаты визуально понятными.

## Сценарии и ожидания

- **Честная передача** — корректный MAC, уникальный Nonce, сообщение принимается.
- **Man in the Middle** — злоумышленник меняет сообщение, но не может пересчитать MAC: проверка падает.
- **Replay** — повторно отправленный пакет с тем же Nonce отклоняется, даже если MAC был валидным в первый раз.
- **Интерактивный MitM** — задаёшь подмену и/или повтор сам, чтобы увидеть реакцию проверки.

## Проверка Python-версии (опционально)

Запустить пример консольного обмена можно так:

```bash
python main.py
```

Сценарии в `main.py` можно включать/выключать прямо в `main()`. Реализация HMAC в `hmac_algo.py` идентична тому, что используется в браузере.
